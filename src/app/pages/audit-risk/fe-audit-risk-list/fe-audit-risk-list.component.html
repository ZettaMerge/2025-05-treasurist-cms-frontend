<div class="_g-header justify-content-between">
  <h1 class="_g-title-header">Audit Risk</h1>
  <button *ngIf="canExport"
    class="btn btn-export"
    (click)="exportReport()"
  >
    <span><i class="ft ft-upload"></i>Export</span>
  </button>
</div>

<!--SECTION FILTER-->
<div class="card">
  <div class="card-body">
    <div class="d-flex">
      <div class="col-6">
        <div class="form-group">
          <label class="col-form-label">ค้นหา</label>
          <div class="form-input">
            <input
              type="text"
              class="form-control"
              placeholder="ชื่อลูกค้า หรือ เลขบัญชีลูกค้า"
              [(ngModel)]="filter.search"
              (ngModelChange)="searchTextChange($event)"
            >
          </div>
        </div>
      </div>
      <div class="col-6">
        <div class="form-group">
          <label class="col-form-label">ช่วงวันที่ส่งคำสั่ง</label>
          <div class="d-flex">
            <div class="flex-1">
              <pn-date-range-picker
                placeholder="dd/mm/yyyy - dd/mm/yyyy"
                [(ngModel)]="filter.dateRange"
                (ngModelChange)="onSelectDateChange()"
              >
              </pn-date-range-picker>
            </div>
            <div class="_btn-clear">
              <button
                type="button"
                class="btn btn-clear btn-lg"
                (click)="clearFilter()"
              >ล้าง
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


<!--SECTION LIST-->
<div class="card">
  <div class="card-body">

    <div>
      <div class="d-flex justify-content-between">
        <div class="col-6 px-0">
          <pn-grid-per-page
            [page]="page"
            (setPerPage)="grid.setPerPage($event)"
          ></pn-grid-per-page>
        </div>
      </div>
      <div
        class="col-12"
        *ngIf="rows && rows?.length === 0"
      >
        <pn-data-not-found>
        </pn-data-not-found>
      </div>
      <div
        [hidden]="rows && rows?.length === 0"
        class="_g-table-container"
      >
        <pn-lib-grid
          #grid
          [sort]="{prop: 'transactionDateTime', asc: false}"
          [bodyHeight]="'auto'"
          [dataSub]="dataSub"
          [rows]="rows"
          [columns]="columns"
          [rowHeight]="65"
          [externalPaging]="true"
          [(page)]="page"
          (pageChange)="pageChange()"
          (sortChange)="onSortChange($event)"
          (detailInfo)="detailInfo($event)"
        ></pn-lib-grid>
      </div>
    </div>
  </div>
</div>

<!--หมายเหตุ-->
<div class="card">
  <div class="card-body">
    <div class="col-12">
      <p class="text-muted _g-text-header-title">หมายเหตุ</p>
    </div>
    <div class="col-12 d-flex">
      <div class="col-6 px-0">
        <p class="text-muted">RED = Redemption</p>
        <p class="text-muted">SUB = Subscription</p>
        <p class="text-muted">DCA = Subscription ที่เกิดจาก DCA</p>
        <p class="text-muted">BSU = Basket Subscription</p>
      </div>
      <div class="col-6 px-0">
        <p class="text-muted">SWO = Redemption ที่เกิดจาก Switching within AMC</p>
        <p class="text-muted">SWI = Subscription ที่เกิดจาก Switching within AMC</p>
        <p class="text-muted">SOC = Redemption ที่เกิดจาก Switching cross AMCs</p>
        <p class="text-muted">SIC = Subscription ที่เกิดจาก Switching cross AMCs</p>
      </div>
    </div>
  </div>
</div>


<!--TEMPLATE-->
<ng-template
  #accountIDTpl
  let-value="value"
  let-row="row"
>
  <!-- <span class="m-0">{{value}}</span>&nbsp; -->
  <shared-datatable-with-name
    [id]="row.fcnAccountId"
    [firstName]="row.customerName"
    [riskLevel]="row.riskLevel"
  >
  </shared-datatable-with-name>

</ng-template>

<ng-template
  #fundTpl
  let-value="value"
  let-row="row"
>
  <!-- <span class="m-0">{{value}}</span>&nbsp; -->
  <shared-datatable-with-name-fund
    [fundCode]="row.fundCode"
    [riskLevel]="row.fundRiskLevel ? row.fundRiskLevel.toString() : ''"
    [fundName]="row.amcCode"
  >
  </shared-datatable-with-name-fund>

</ng-template>

<ng-template
  #acceptRiskTpl
  let-value="value"
  let-row="row"
>
  <span
    *ngIf="value === 'Y'"
    class="text-dark-blue-light font-large-1"
  ><i class="ft-check"></i></span>
  <span
    *ngIf="value === 'N' "
    class="text-muted font-large-1"
  ><i class="ft-x"></i></span>
</ng-template>
